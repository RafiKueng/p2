
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Mass models}\label{sec:massmodels}



Once a spaghetti diagram has been drawn on a web browser, it is
forwarded to a server-side numerical framework, which searches for
mass maps consistent with the image locations, parities and time
ordering, given by the modeller.  The mass maps are made up of mass
tiles and are free-form, but are required to be concentrated around
the identified lens centre \citep[see][for the precise formulation of
the search problem]{2014MNRAS.445.2181C}.  The modeller can also set
various options for the search, such as the number of mass tiles and
the extent of the mass map; all options have defaults.  Typically,
there are $\sim500$ mass tiles arranged in a disc, centred on the
lensing galaxy and extending to twice the radius of the outermost
image.  By default, the mass distributed is required to have
$180^\circ$ rotation symmetry, but this option can be unset.  Assuming
mass distributions can be found -- which in practice is usually the
case -- a statistical ensemble of two-dimensional mass maps is
returned.  This ensemble, along with derived quantities and
uncertainties, makes up one SpaghettiLens model.

The mass will naturally depend on the lens and source redshifts, which
are unknown when a lens candidate is first identified.  However, this
is not a problem, because a model can be trivially rescaled to use
better redshift values, as they become available.  The mass
normalisation of the models is proportional, through the angular
critical density, to the factor $d_L\, d_S\, d_{LS}^{-1}$, where
$d_L,d_S$ and $d_{LS}$ are the usual angular-diameter distances.  In
the redshift ranges typical of galaxy lensing, the normalisation
factor is roughly proportional to the lens redshift, and weakly
dependent on the source redshift.  This work applies photometric
redshifts from the CFHTLS pipeline \citep{2009A&A...500..981C} to the
candidate lensing galaxies; the values range from $z=0.2$ to 1 (see
Table~\ref{tab:models}).  The source redshifts are assumed as $z=2$,
unless an unambiguous photometric redshift is available.  The lens
redshifts entail rather big uncertainties, up to a few tens of percent
\citep[see Fig.~5 in][]{2009A&A...500..981C}. The lensing masses would
be uncertain at the same level.  On the other hand, the lensing masses
in the sample range from $10^{11}M_\odot$ to $10^{13}M_\odot$; in
comparison, the redshift uncertainty is not so important in this
preliminary analysis.

The ensemble of mass maps can be post-processed in many different
ways.  Four different graphical quantities are particularly useful.

Fig.~\ref{fig:arriv} shows the arrival-time surfaces corresponding to
the spaghetti diagrams of Fig.~\ref{fig:splinput}.  The arrival-time
contours look like machine-made elaborations of the input spaghetti
diagrams.  If the saddle-point contours in the arrival time are
qualitatively the same as the curves in the spaghetti diagram (the
detailed shape of the spaghetti curves is unimportant), it immediately
suggests a successful model.  On the other hand, if the arrival-time
surface has unexpected minima or saddle points, and especially if the
unexpected features are far from identified lens images, that signals
an improbable model.  Fig.~\ref{fig:synth} shows what we call synthetic
images, meaning reconstructions of the extended lensed features by
fitting for a source.  These were generated by a new method, explained
in Appendix~\ref{subsec:sourcefit}, implemented during the offline
post-processing after the modelling process was complete.  The
synthetic images provided by SpaghettiLens during the collaborative
modelling and discussion were more crude; those are included in the
online supplement.

The arrival-time surface and synthetic image are summarised by one
diagnostic, the most important of all: are the lensed features
satisfactorily reproduced?  This diagnostic remains a judgment call by
modellers.  A useful quantitative criterion for whether the synthetic
image is consistent with the data would need to allow for PSF
dependence and unmodelled substructure -- otherwise all models would
be summarily rejected, something left for a future implementation
in SpaghettiLens.


Fig.~\ref{fig:kappa} shows the projected mass maps of the sample.  In
fact, this figure only shows the ensemble-average mass maps, and not
the variation within the ensemble, from which uncertainties can be
inferred. The same applies to the arrival-time surfaces and synthetic
images in the previous two figures. The uncertainties will be shown in
a concise form in Fig.~\ref{fig:encl}.  Fig.~\ref{fig:kappa} makes
evident the tiled nature of the mass model.  The tiles can be smoothed
over by interpolation, and this was done in the mass maps during the
modelling process, available in the online version.  It is
interesting, however, to note the tiling artifacts, if only as a
reminder that the substructure in the mass distribution is very
uncertain, even if some integrated quantities are  well
constrained.  How the free-form mass maps relate to parameterised lens
models is discussed in Appendix~\ref{subsec:parameter}.
Note that although the mass distribution can have discontinuous jumps,
the lens equation and arrival-time surface are continuous.

Fig.~\ref{fig:encl} shows the enclosed-mass profiles, expressed as the
average convergence, $\kappa$, within circles of given projected
radius.  Uncertainties are included (see the figure caption for
details).
Appendix~\ref{subsec:hires} describes the improvements made
since our earlier work \citep{2015MNRAS.447.2170K}, to allow for
steeper profiles in the inner regions.  The enclosed mass is typically
best constrained at the notional Einstein radius, becoming more
uncertain at larger and smaller radii.

The mass maps and mass profiles are the basis of a further diagnostic:
are the mass distributions plausible? This is also a judgment call
made by modellers, but it showed to be a powerful diagnostic,
summarizing three aspects. The overall shape is forced to be
$180^\circ$-rotation symmetric, usually a plausible assumption, but
volunteers can deactivate this constraint. The profile slope turned
out to be a good indicator of plausible models, as can seen by
contrasting model \sw{57} with the rest of the sample:  The missing
core in Fig.~\ref{fig:kappa} and the flat profile in
Fig.~\ref{fig:encl} disqualify this model. The clumpiness of the
mass map is another useful indicator. Flat profile slopes can often be
identified directly in the mass map, where the mass tiles form a
checkerboard pattern.


